<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>GTV: Fast multipole calculations</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
  </ul>
</div>
<h1>Fast multipole calculations</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef gpointer(*)&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a> (GtsVertex *v, gpointer data)</td></tr>

<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multipole.html#g28a30164b4a43ededbb71ecd2fbb9acc">GtvFieldType</a> { <a class="el" href="group__multipole.html#gg28a30164b4a43ededbb71ecd2fbb9acc70cc63b22bf4d225df214a151ff16b96">GTV_FIELD_SCALAR</a>, 
<a class="el" href="group__multipole.html#gg28a30164b4a43ededbb71ecd2fbb9accea7d2196a78d5a333426bc250bdab16f">GTV_FIELD_CURL</a>
 }</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">gint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multipole.html#gf3de547a6ad9be8f3aab4a8664c1706d">gtv_multipole_box_moment_coefficients</a> (<a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a> *box, gint order)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">gint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multipole.html#gadfa67eaf4da3f7c19a80c1a6331b17e">gtv_multipole_leaf_moment_coefficients</a> (GNode *tree, gint order)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">gint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multipole.html#g6b7cab3484d7b52eac5f5386d8e3cc0e">gtv_multipole_box_moments</a> (<a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a> *box, gint stride, <a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a> func, gpointer data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">gint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multipole.html#g53c82e02d621afefac875df226dbcb1b">gtv_multipole_leaf_moments</a> (GNode *tree, gint stride, <a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a> func, gpointer data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">gint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multipole.html#ge5eb965af28a50f1dd4c938e65ac443e">gtv_multipole_box_shift_moments</a> (<a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a> *dest, <a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a> *source)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">gint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multipole.html#g22a1579ed5951869f7e0408015ee2045">gtv_multipole_tree_moments</a> (GNode *tree)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">gint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multipole.html#ga2130f4f017a5ae2ea846de5b5bd6603">gtv_multipole_moments</a> (GNode *tree, gint order, gint stride, <a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a> func, gpointer data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">gint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multipole.html#g8b73c9ea12056b1ea56b3f5f49ee3530">gtv_multipole_distances</a> (GtsVector r, gint a, gint H, GArray *dR)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">gint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multipole.html#g06f688be0fec4469cf1f5d346f757e69">gtv_multipole_field_amm</a> (GNode *tree, gint a, <a class="el" href="group__multipole.html#g28a30164b4a43ededbb71ecd2fbb9acc">GtvFieldType</a> field, <a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a> func, gpointer data, gdouble tol, GtsPoint *x, gdouble *I, GtvEvaluationStats *s)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
These functions allow GTV to be used to perform accelerated volume integrations of potential-type integrands, using <a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a> trees, based mainly on Marshall, J. S., Grant, J. R., Gossler, A. A. and Huyer, S. A. `Vorticity transport on a Lagrangian mesh', Journal of Computational Physics, 161:181--113 (2000), <a href="http://dx.doi.org/10.1006/jcph.2000.6490">http://dx.doi.org/10.1006/jcph.2000.6490</a> <hr><h2>Typedef Documentation</h2>
<a class="anchor" name="g285a7a75518ef947864239e7ff97b2c4"></a><!-- doxytag: member="gtv.h::GtvLookupFunc" ref="g285a7a75518ef947864239e7ff97b2c4" args="(GtsVertex *v, gpointer data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Lookup function for calculating multipole moments. If <em>func</em> is a <a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a> then <em>func</em>(<em>v</em>, <em>data</em>) returns a gpointer to data associated with <em>v</em>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>v</em>&nbsp;</td><td>a GtsVertex </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>user data passed by the calling GTV function</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>a pointer of type gpointer to data which will be used in calculating a multipole expansion. </dd></dl>

</div>
</div><p>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="g28a30164b4a43ededbb71ecd2fbb9acc"></a><!-- doxytag: member="gtv.h::GtvFieldType" ref="g28a30164b4a43ededbb71ecd2fbb9acc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__multipole.html#g28a30164b4a43ededbb71ecd2fbb9acc">GtvFieldType</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Field types for multipole integrations. <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gg28a30164b4a43ededbb71ecd2fbb9acc70cc63b22bf4d225df214a151ff16b96"></a><!-- doxytag: member="GTV_FIELD_SCALAR" ref="gg28a30164b4a43ededbb71ecd2fbb9acc70cc63b22bf4d225df214a151ff16b96" args="" -->GTV_FIELD_SCALAR</em>&nbsp;</td><td>
scalar field, e.g. potential </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg28a30164b4a43ededbb71ecd2fbb9accea7d2196a78d5a333426bc250bdab16f"></a><!-- doxytag: member="GTV_FIELD_CURL" ref="gg28a30164b4a43ededbb71ecd2fbb9accea7d2196a78d5a333426bc250bdab16f" args="" -->GTV_FIELD_CURL</em>&nbsp;</td><td>
curl field, e.g. Biot-Savart law </td></tr>
</table>
</dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="gf3de547a6ad9be8f3aab4a8664c1706d"></a><!-- doxytag: member="multipole.c::gtv_multipole_box_moment_coefficients" ref="gf3de547a6ad9be8f3aab4a8664c1706d" args="(GtvOctTreeBox *box, gint order)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint gtv_multipole_box_moment_coefficients           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a> *&nbsp;</td>
          <td class="paramname"> <em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&nbsp;</td>
          <td class="paramname"> <em>order</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate the vertex coefficients for the multipole moments of a set of tetrahedra contained in a <a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>box</em>&nbsp;</td><td>a <a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a> containing a list of <a class="el" href="structGtvTetrahedron.html">GtvTetrahedron</a>'s; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>order</em>&nbsp;</td><td>order of multipole moments, no greater than 16.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="group__status.html#ggfb23c4ddc35e1ea652487a43f9a0f8a9d86eb3314eb116aa31f1ef794fbfd732">GTV_SUCCESS</a> on success. </dd></dl>

</div>
</div><p>
<a class="anchor" name="g6b7cab3484d7b52eac5f5386d8e3cc0e"></a><!-- doxytag: member="multipole.c::gtv_multipole_box_moments" ref="g6b7cab3484d7b52eac5f5386d8e3cc0e" args="(GtvOctTreeBox *box, gint stride, GtvLookupFunc func, gpointer data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint gtv_multipole_box_moments           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a> *&nbsp;</td>
          <td class="paramname"> <em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&nbsp;</td>
          <td class="paramname"> <em>stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a>&nbsp;</td>
          <td class="paramname"> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gpointer&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculate the multipole moments for a <a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>box</em>&nbsp;</td><td>a <a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a>; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>stride</em>&nbsp;</td><td>the number of components in the data to be expanded; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>func</em>&nbsp;</td><td>a <a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a> which returns the data associated with a given vertex, which must have at least <em>stride</em> components available; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to be passed to <em>func</em>.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="group__status.html#ggfb23c4ddc35e1ea652487a43f9a0f8a9d86eb3314eb116aa31f1ef794fbfd732">GTV_SUCCESS</a> on success. </dd></dl>

</div>
</div><p>
<a class="anchor" name="ge5eb965af28a50f1dd4c938e65ac443e"></a><!-- doxytag: member="multipole.c::gtv_multipole_box_shift_moments" ref="ge5eb965af28a50f1dd4c938e65ac443e" args="(GtvOctTreeBox *dest, GtvOctTreeBox *source)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint gtv_multipole_box_shift_moments           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a> *&nbsp;</td>
          <td class="paramname"> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a> *&nbsp;</td>
          <td class="paramname"> <em>source</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Shift multipole moments generated for one <a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a> to another. The coefficient array in <em>dest</em> is automatically resized to match <em>source</em> before inserting data.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>destination <a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a>; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>source <a class="el" href="structGtvOctTreeBox.html">GtvOctTreeBox</a>, with already-generated multipole coefficients.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="group__status.html#ggfb23c4ddc35e1ea652487a43f9a0f8a9d86eb3314eb116aa31f1ef794fbfd732">GTV_SUCCESS</a> on success. </dd></dl>

</div>
</div><p>
<a class="anchor" name="g8b73c9ea12056b1ea56b3f5f49ee3530"></a><!-- doxytag: member="multipole.c::gtv_multipole_distances" ref="g8b73c9ea12056b1ea56b3f5f49ee3530" args="(GtsVector r, gint a, gint H, GArray *dR)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint gtv_multipole_distances           </td>
          <td>(</td>
          <td class="paramtype">GtsVector&nbsp;</td>
          <td class="paramname"> <em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&nbsp;</td>
          <td class="paramname"> <em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GArray *&nbsp;</td>
          <td class="paramname"> <em>dR</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculate the spatial derivatives of <img class="formulaInl" alt="$1/R^{q}$" src="form_14.png">, <img class="formulaInl" alt="$1\leq q\leq a$" src="form_16.png"> up to order <img class="formulaInl" alt="$H$" src="form_8.png">, with <img class="formulaInl" alt="$R=||\mathbf{r}||$" src="form_17.png">. The derivatives are returned in a GArray of gdouble values, with the first row being the derivatives of <img class="formulaInl" alt="$R$" src="form_10.png"> and subsequent rows being derivatives of <img class="formulaInl" alt="$R^{-1}$" src="form_11.png">, <img class="formulaInl" alt="$R^{-2}$" src="form_12.png">, etc. To access a given derivative, note that the list of derivatives at each order takes up mpole_block_start(H+1) entries in <em>dR</em>, and use gtv_multipole_index_mnk() to find <img class="formulaInl" alt="$\partial^{m+n+k}R^{-a}/\partial x^{m}\partial y^{n}\partial z^{k}$" src="form_13.png">. For example, if N=mpole_block_start(H+1), the derivatives of <img class="formulaInl" alt="$\/R^{4}$" src="form_18.png"> (if computed) start at &amp;(g_array_index(dR,gdouble,(4*N))).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>r</em>&nbsp;</td><td>displacement vector from centre of multipole expansion box to field point; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>maximum inverse power of distance to consider; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>H</em>&nbsp;</td><td>maximum order of derivatives; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dR</em>&nbsp;</td><td>array of derivatives.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="group__status.html#ggfb23c4ddc35e1ea652487a43f9a0f8a9d86eb3314eb116aa31f1ef794fbfd732">GTV_SUCCESS</a> on success. </dd></dl>

</div>
</div><p>
<a class="anchor" name="g06f688be0fec4469cf1f5d346f757e69"></a><!-- doxytag: member="multipole.c::gtv_multipole_field_amm" ref="g06f688be0fec4469cf1f5d346f757e69" args="(GNode *tree, gint a, GtvFieldType field, GtvLookupFunc func, gpointer data, gdouble tol, GtsPoint *x, gdouble *I, GtvEvaluationStats *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint gtv_multipole_field_amm           </td>
          <td>(</td>
          <td class="paramtype">GNode *&nbsp;</td>
          <td class="paramname"> <em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__multipole.html#g28a30164b4a43ededbb71ecd2fbb9acc">GtvFieldType</a>&nbsp;</td>
          <td class="paramname"> <em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a>&nbsp;</td>
          <td class="paramname"> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gpointer&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble&nbsp;</td>
          <td class="paramname"> <em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GtsPoint *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&nbsp;</td>
          <td class="paramname"> <em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GtvEvaluationStats *&nbsp;</td>
          <td class="paramname"> <em>s</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Accelerated multipole method evaluation of the field associated with a particular set of multipole coefficients and a source function, using a method based on that of Marshall, J. S., Grant, J. R., Gossler, A. A. and Huyer, S. A., `Vorticity transport on a Lagrangian tetrahedral mesh', Journal of Computational Physics, 161(1):85-113, 2000, <a href="http://dx.doi.org/10.1006/jcph.2000.6490.">http://dx.doi.org/10.1006/jcph.2000.6490.</a> The computation returns an estimate of <img class="formulaInl" alt="$I(\mathbf{x})=\int_{V} f(\mathbf{x}_{1})/R^{a}\mathrm{d}V$" src="form_20.png"> with <img class="formulaInl" alt="$f(\mathbf{x}_{1})$" src="form_26.png"> depending on the type of field selected.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tree</em>&nbsp;</td><td>a tree of multipole coefficients computed with, for example, <a class="el" href="group__multipole.html#ga2130f4f017a5ae2ea846de5b5bd6603">gtv_multipole_moments</a>; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>the power of distance in the field integral; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>field</em>&nbsp;</td><td>a field description of type <a class="el" href="group__multipole.html#g28a30164b4a43ededbb71ecd2fbb9acc">GtvFieldType</a>. For <a class="el" href="group__multipole.html#gg28a30164b4a43ededbb71ecd2fbb9acc70cc63b22bf4d225df214a151ff16b96">GTV_FIELD_SCALAR</a> <img class="formulaInl" alt="$I(\mathbf{x})=\int_{V}f(\mathbf{x}_{1})/R^{a}\mathrm{d}V$" src="form_22.png">. For <a class="el" href="group__multipole.html#gg28a30164b4a43ededbb71ecd2fbb9accea7d2196a78d5a333426bc250bdab16f">GTV_FIELD_CURL</a> <img class="formulaInl" alt="$I(\mathbf{x})=\int_{V}\mathbf{f}(\mathbf{x}_{1})\times\mathbf{r} /R^{a}\mathrm{d}V$" src="form_23.png">, where <img class="formulaInl" alt="$f$" src="form_24.png"> and <img class="formulaInl" alt="$\mathbf{f}$" src="form_25.png"> are the data returned by <em>func</em>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>func</em>&nbsp;</td><td>a <a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a> returning the source strength; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>user data to pass to <em>func</em>; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tol</em>&nbsp;</td><td>accuracy required in estimation (of dubious utility at the moment); </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>field evaluation point; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>I</em>&nbsp;</td><td>on exit, value of field integral; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>a GtvEvaluationStats containing information about the evaluation.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>GTV_SUCCESS on success. </dd></dl>

</div>
</div><p>
<a class="anchor" name="gadfa67eaf4da3f7c19a80c1a6331b17e"></a><!-- doxytag: member="multipole.c::gtv_multipole_leaf_moment_coefficients" ref="gadfa67eaf4da3f7c19a80c1a6331b17e" args="(GNode *tree, gint order)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint gtv_multipole_leaf_moment_coefficients           </td>
          <td>(</td>
          <td class="paramtype">GNode *&nbsp;</td>
          <td class="paramname"> <em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&nbsp;</td>
          <td class="paramname"> <em>order</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculate the vertex coefficients for each leaf of an octtree, by calling <a class="el" href="group__multipole.html#gf3de547a6ad9be8f3aab4a8664c1706d">gtv_multipole_box_moment_coefficients</a> for each leaf.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tree</em>&nbsp;</td><td>a GNode at the root of the octtree; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>order</em>&nbsp;</td><td>order of multipole moments.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="group__status.html#ggfb23c4ddc35e1ea652487a43f9a0f8a9d86eb3314eb116aa31f1ef794fbfd732">GTV_SUCCESS</a> on success. </dd></dl>

</div>
</div><p>
<a class="anchor" name="g53c82e02d621afefac875df226dbcb1b"></a><!-- doxytag: member="multipole.c::gtv_multipole_leaf_moments" ref="g53c82e02d621afefac875df226dbcb1b" args="(GNode *tree, gint stride, GtvLookupFunc func, gpointer data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint gtv_multipole_leaf_moments           </td>
          <td>(</td>
          <td class="paramtype">GNode *&nbsp;</td>
          <td class="paramname"> <em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&nbsp;</td>
          <td class="paramname"> <em>stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a>&nbsp;</td>
          <td class="paramname"> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gpointer&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculate the multipole moments for each leaf of an octtree, by calling <a class="el" href="group__multipole.html#g6b7cab3484d7b52eac5f5386d8e3cc0e">gtv_multipole_box_moments</a> for each leaf.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tree</em>&nbsp;</td><td>a GNode at the root of the octtree. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>stride</em>&nbsp;</td><td>the number of components in the data to be expanded; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>func</em>&nbsp;</td><td>a <a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a> which returns the data associated with a given vertex, which must have at least <em>stride</em> components available; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to be passed to <em>func</em>.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="group__status.html#ggfb23c4ddc35e1ea652487a43f9a0f8a9d86eb3314eb116aa31f1ef794fbfd732">GTV_SUCCESS</a> on success. </dd></dl>

</div>
</div><p>
<a class="anchor" name="ga2130f4f017a5ae2ea846de5b5bd6603"></a><!-- doxytag: member="multipole.c::gtv_multipole_moments" ref="ga2130f4f017a5ae2ea846de5b5bd6603" args="(GNode *tree, gint order, gint stride, GtvLookupFunc func, gpointer data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint gtv_multipole_moments           </td>
          <td>(</td>
          <td class="paramtype">GNode *&nbsp;</td>
          <td class="paramname"> <em>tree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&nbsp;</td>
          <td class="paramname"> <em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&nbsp;</td>
          <td class="paramname"> <em>stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a>&nbsp;</td>
          <td class="paramname"> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gpointer&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate a full tree of multipole moments.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tree</em>&nbsp;</td><td>a GNode for the root of a tree generated using <a class="el" href="group__octtree.html#g9905123c09fc9b457e0e50fe52871035">gtv_oct_tree_new</a>; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>order</em>&nbsp;</td><td>the maximum order of the moments; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>stride</em>&nbsp;</td><td>the number of components in the function to be expanded; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>func</em>&nbsp;</td><td>a <a class="el" href="group__multipole.html#g285a7a75518ef947864239e7ff97b2c4">GtvLookupFunc</a> which returns a pointer to the vertex data for the moments; </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>user data to be passed to <em>func</em>.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="group__status.html#ggfb23c4ddc35e1ea652487a43f9a0f8a9d86eb3314eb116aa31f1ef794fbfd732">GTV_SUCCESS</a> on success. </dd></dl>

</div>
</div><p>
<a class="anchor" name="g22a1579ed5951869f7e0408015ee2045"></a><!-- doxytag: member="multipole.c::gtv_multipole_tree_moments" ref="g22a1579ed5951869f7e0408015ee2045" args="(GNode *tree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint gtv_multipole_tree_moments           </td>
          <td>(</td>
          <td class="paramtype">GNode *&nbsp;</td>
          <td class="paramname"> <em>tree</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate a full tree of multipole moments, starting from already-generated leaf nodes (use <a class="el" href="group__multipole.html#g53c82e02d621afefac875df226dbcb1b">gtv_multipole_leaf_moments</a>).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tree</em>&nbsp;</td><td>an octtree with initialized leaves.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="group__status.html#ggfb23c4ddc35e1ea652487a43f9a0f8a9d86eb3314eb116aa31f1ef794fbfd732">GTV_SUCCESS</a> on success. </dd></dl>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Dec 8 09:09:11 2008 for GTV by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
